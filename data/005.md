## SQL-injection with data efiltration

Since I could do a login bypass with SQL injection I figured I could do one where I can exfiltrate user data.

First I figured I should find a suitable space for it, I started checking out the search bar. and see if it is vulnerable to SQL injection, and it was.

![1=1](<../images/2026-03-01 - SQL 1=1.png>)

With this in mind I fire up SQLmap and try to go at it that way. After some work figuring out a couple of different ways the database is vulnerable, both union, boolean-based blind and time-based blind variations I start exfiltrating the data.

![SQLmap](<../images/2026-03-01 - SQLmap tables.png>)

Through SQLmap I seem to get everything, but I want to double check with Burp Suite, so I craft a union based payload and exfiltrate the important bits of information I want. e-mail, password were the most important, and a couple of other columns were added aswell.

![Burp union](<../images/2026-03-01 - SQL union burp.png>)

The payload I ended up using here was.

    TEST%')) UNION ALL SELECT id,email,username,password,totpSecret,NULL,NULL,NULL,NULL FROM Usersâ€“

With this I ended up getting all the user data and I noticed something odd. My SQLmap run earlier had actually mixed up the order of e-mails and passwords, so they did not match, which I found strange, not sure what was up with that.

![Green popup](<../images/2026-03-01 - SQL user cred success.png>)

A short summary of how to protect yourself against this type of SQL injection attack.

Prepared statements separate user input from SQL query code so that input can never be interpreted as executable SQL. There are several trusted and verified libraries and frameworks we could use to implement this in our code. We get strong protection against SQL injection with correct setup and configuration of these frameworks.

